services:
  frontend:
    build: .
    container_name: solid_dataspace_manager_frontend
    volumes:
      - ./:/app:delegated
      - /app/node_modules
    stdin_open: true
    environment:
      - REACT_APP_OIDC_ISSUER=https://solidcommunity.net
      - REACT_APP_REDIRECT_URL=${REACT_APP_REDIRECT_URL:-http://localhost}
      - REACT_APP_FOOTER_LOGOS=/assets/images/Logo_GesundesTal.png,/assets/images/Icon_GesundesTal.png
      - REACT_APP_VERSION=0.5.0
      - PORT=5000
    tty: true
    ports:
      - "${FRONTEND_PORT:-5000}:5000"

  caddy:
    image: caddy:2
    container_name: reverse_proxy_solid_dataspace_manager
    depends_on:
      - frontend
    ports:
      - "${CADDY_HTTP_PORT:-80}:80"
      - "${CADDY_HTTPS_PORT:-443}:443"
    volumes:
      - ${CADDYFILE:-./Caddyfile}:/etc/caddy/Caddyfile
      - caddy_data:/data
      - caddy_config:/config

volumes:
  node_modules:
  caddy_data:
  caddy_config:
